<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h1>ğŸ“Š Admin Dashboard</h1>

<div class="dashboard-card">
  <canvas id="issueChart"></canvas>
</div>

<div id="adminIssues"></div>

<script>
let issues = JSON.parse(localStorage.getItem("issues")) || [];
const adminIssues = document.getElementById("adminIssues");

function loadIssues(){
  adminIssues.innerHTML = "";
  issues.forEach((issue, index) => {
    let imagesHTML = "";
    if(issue.images && issue.images.length > 0){
      imagesHTML = issue.images.map(img => `<img src="${img}" style="width:100px;height:100px;object-fit:cover;margin:5px;border-radius:10px;">`).join("");
    }
    adminIssues.innerHTML += `
      <div class="issue-card">
        <b>${issue.category}</b><br>
        ğŸ“ ${issue.location}<br>
        ğŸŒ ${issue.exactLocation}<br>
        ğŸ“ ${issue.description}<br>
        Priority: ${issue.priority}<br>
        Status: <b>${issue.status}</b><br>
        ${imagesHTML}
        <br><br>
        <button onclick="resolveIssue(${index})">Mark Resolved</button>
      </div>
    `;
  });
}

function resolveIssue(index){
  issues[index].status = "Resolved";
  localStorage.setItem("issues", JSON.stringify(issues));
  loadIssues();
}

const pending = issues.filter(i => i.status === "Pending").length;
const resolved = issues.filter(i => i.status === "Resolved").length;

new Chart(document.getElementById("issueChart"), {
  type: "doughnut",
  data: {
    labels: ["Pending", "Resolved"],
    datasets: [{ data: [pending, resolved] }]
  }
});

loadIssues();
</script>

</body>
</html>
